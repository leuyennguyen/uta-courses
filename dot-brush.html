<script src="https://cdn.jsdelivr.net/npm/underscore@1.13.2/underscore-umd-min.js
"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="js/ruler.js"></script>
<script src="js/canvas-toBlob.js"></script>
<script src="js/clipper.js"></script>
<script src="js/file_saver.min.js"></script>
<script src="js/paper-full.js"></script>
<script src="js/paper-extra.js"></script>
<script src="js/PaperDesignTool.js"></script>


<script type="text/javascript">
	CIRCLE_RADIUS = 50;

	/* Main function */
	$(function(){
		window.tool = new PaperDesignTool({canvas: $('canvas')})
		$("button#download-svg").click(function(){window.tool.save_svg()})
		
		// COMMENT IN AND OUT TO ACTIVATE THE SPECIFIC BRUSH
		//bead_brush()
		//variable_size_bead_brush()
		variable_location_bead_brush()

		paper.view.update()
	})


	function bead_brush(){
		console.log("\t", "Brush Routine 1")

		// TODO: YOUR CODE HERE		
		paper.tool = new paper.Tool({
			minDistance: 10,
			onMouseDown: function(e){
				console.log ("MD")
				this.p = new paper.Path({
					strokeColor: "black",
					strokeWidth: 5
				})
				this.p.add(e.point)
			},
			onMouseDrag: function(e){
				this.p.add(e.point)
			},
			onMouseUp: function(e){
				scope = this
				this.p.add(e.point)
				//TODO
				var path = this.p.clone();
				for (var offset =  0 ; offset < path.length ; offset+=10) {
					var point = path.getPointAt(offset);
					var circle = new paper.Path.Circle({
						center: point,
						radius: 5,
						fillColor: "yellow"
					});
				}
			}
		})
	}
	function variable_size_bead_brush(){
		console.log("\t", "Brush Routine 2")

		// TODO: YOUR CODE HERE		
		paper.tool = new paper.Tool({
			minDistance: 10,
			onMouseDown: function(e){
				console.log ("MD")
				this.p = new paper.Path({
					strokeColor: "black",
					strokeWidth: 5
				})
				this.p.add(e.point)
			},
			onMouseDrag: function(e){
				this.p.add(e.point)
			},
			onMouseUp: function(e){
				scope = this
				this.p.add(e.point)
				//TODO
				var path = this.p.clone();
				for (var offset =  0 ; offset < path.length ; offset+=20) {
					var point = path.getPointAt(offset);
					var circle = new paper.Path.Circle({
						center: point,
						radius: Math.random()*(5-2.5)+2.5,
						fillColor: "yellow"
					});
				}

			}
		})
	}
	function variable_location_bead_brush(){
		console.log("\t", "Brush Routine 3")
		
		// TODO: YOUR CODE HERE		
		paper.tool = new paper.Tool({
			minDistance: 10,
			onMouseDown: function(e){
				console.log ("MD")
				this.p = new paper.Path({
					strokeColor: "black",
					strokeWidth: 5
				})
				this.p.add(e.point)
			},
			onMouseDrag: function(e){
				this.p.add(e.point)
			},
			onMouseUp: function(e){
				scope = this
				this.p.add(e.point)
				//TODO
				var path = this.p.clone();
				for (var offset =  0 ; offset < path.length ; offset+=20) {
					var random = Math.random() * (20 - (-20)) + (-20);

					var point = path.getPointAt(offset);
					var normal = path.getNormalAt(offset).multiply(random);

					if (random < 0) {
						normal.length *= 2;
					}

					var line = new paper.Path({segments: [point, point.add(normal)]});

					var dist = line.getPointAt(random);
					if (dist === null) {
						dist = point;
					}
					circle = new paper.Path.Circle({
						center: dist,
						radius: 5,
						fillColor: "yellow"
					});
				}
			}
		})
	}
</script>

<link href="css/application.css" rel="stylesheet"/>
<canvas resize> Hello </canvas>
<button id="download-svg"> SVG </button>